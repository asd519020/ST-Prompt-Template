# 🤰 SillyTavern 怀孕系统

一个为 SillyTavern EJS 模板扩展设计的完整怀孕模拟系统。

## ✨ 核心特性

### 🧠 妊娠察觉度系统
- **无意识期** (0-24): 角色完全不知道自己怀孕
- **怀疑期** (25-49): 开始怀疑但不确定
- **确认期** (50-74): 确认怀孕但信息有限
- **完全察觉期** (75-100): 完全了解胎儿状况

### 🏥 真实分娩模拟
- **产前阵痛** (0-3小时): 宫缩开始，羊水未破
- **第一产程** (3-6小时): 破水，胎儿下降
- **第二产程** (6-9小时): 渐进式娩出过程
- **完成**: 新生儿降生

### 🎲 随机性和真实感
- 预产期有概率触发（基础30%）
- 过期妊娠概率递增
- 最多过期14天强制分娩
- 自动时间检测（识别"三个月后"等表述）

### 🎭 性格化反应
- **冷漠型**: 知道但不在意
- **母性型**: 温柔期待
- **暴躁型**: 愤怒咒骂
- **恐惧型**: 害怕颤抖
- 完全由 LLM 根据角色性格自由发挥

## 📦 文件说明

```
pregnancy_system_worldinfo.json        # 核心系统和命令
pregnancy_system_worldinfo_part2.json  # LLM指导和UI显示
pregnancy_system_quickreply.json       # 快速回复按钮
PREGNANCY_SYSTEM_INSTALLATION.md       # 详细安装和测试指南
PREGNANCY_SYSTEM_README.md             # 本文档
```

## 🚀 快速开始

### 1. 安装
1. 在 SillyTavern 导入两个世界书 JSON 文件
2. 导入快速回复配置（可选）
3. 在 System Prompt 中添加：
   ```ejs
   <%- getPromptsInjected('labor_guidance') %>
   <%- getPromptsInjected('pregnancy_awareness') %>
   ```

### 2. 基础使用
```
/pregnant Lily              # 让 Lily 怀孕
/pregnant-status            # 查看状态
/pregnant-advance 7         # 推进 7 天
/pregnant-awareness Lily    # 查看察觉度
/pregnant-test Lily         # 验孕棒测试
/pregnant-doctor Lily       # 产检
```

### 3. 测试流程
```
1. /pregnant Lily
2. /pregnant-advance 42     # 6周
3. /pregnant-test Lily      # 验孕
4. 对话观察反应
5. /pregnant-doctor Lily    # 产检
6. /pregnant-advance 238    # 到预产期
7. 等待分娩自动触发或手动触发
```

## 📊 系统架构

```
┌─────────────────────────────────────┐
│   妊娠察觉度系统                      │
│   - 自动增长                          │
│   - 事件触发（验孕、产检）              │
│   - LLM 指导注入                      │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│   时间推进系统                        │
│   - 手动推进                          │
│   - 自动检测时间跳跃                   │
│   - 孕期阶段管理                      │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│   分娩触发系统                        │
│   - 概率检测                          │
│   - 过期妊娠递增                      │
│   - 强制触发机制                      │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│   分娩阶段系统                        │
│   - 三阶段推进                        │
│   - 生理状态描述                      │
│   - 性格化 LLM 指导                   │
└─────────────────────────────────────┘
```

## 🎮 功能展示

### 无意识期示例
```
User: Lily最近怎么样？
AI: Lily皱了皱眉，感觉最近总是疲倦。"可能是工作太累了吧。"
她想着，完全没有意识到真正的原因。

[状态栏]
🤷 Lily - 无意识期 (8%)
🤰 4周 | 距预产期: 252天
💭 Lily还没有意识到...
```

### 怀疑期示例
```
User: Lily注意到什么了吗？
AI: Lily突然意识到自己已经两个月没来月经了。她的心跳加速。
"该不会是...不，不可能..."她喃喃自语，不敢相信这个可能性。

[状态栏]
🤔 Lily - 怀疑期 (32%)
🤰 8周 | 距预产期: 224天
```

### 分娩期示例
```
User: 描述分娩过程
AI: 随着Lily用力，婴儿的头顶渐渐显露出来。"我看到头了！"助产士
鼓励道。Lily咬紧牙关，汗水湿透了她的头发...

[状态栏]
🤰 Lily - 第二产程（娩出期）
进度: ████████░░ 65%
⏱️ 7.5 / 9 小时
```

## 🎨 特色亮点

✅ **完全尊重角色性格** - 不强制任何情绪反应
✅ **真实生理过程** - 基于医学事实的阶段划分
✅ **智能 LLM 指导** - 只提供客观信息，由 AI 自由发挥
✅ **用户友好界面** - 彩色状态栏，清晰命令系统
✅ **高度可配置** - 可调整触发概率、时间倍率等
✅ **模块化设计** - 易于扩展和维护
✅ **零编程门槛** - 玩家只需点击按钮或输入简单命令

## 📖 详细文档

请阅读 `PREGNANCY_SYSTEM_INSTALLATION.md` 获取：
- 详细安装步骤
- 完整测试流程
- 故障排除指南
- 高级配置选项
- 所有命令说明

## 🔮 未来计划

可能的扩展功能：
- [ ] 多胎妊娠（双胞胎、三胞胎）
- [ ] 产后恢复系统
- [ ] 哺乳期模拟
- [ ] 并发症系统
- [ ] 胎儿性别识别
- [ ] 产前教育事件
- [ ] 待产包准备
- [ ] 分娩方式选择（顺产/剖腹产）

## ⚠️ 注意事项

- 本系统基于 SillyTavern EJS 模板扩展
- 需要启用 Prompt Template 扩展
- 建议在测试环境先试用
- LLM 的反应质量取决于模型能力和角色卡质量
- 某些 API 可能对医疗内容有限制

## 📄 许可证

本项目遵循 AGPL-3.0 许可证

---

**开发者**: Claude + 用户协作
**版本**: 1.0
**最后更新**: 2025

如有问题或建议，欢迎反馈！🎉
