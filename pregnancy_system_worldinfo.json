{
  "name": "Pregnancy System",
  "description": "å®Œæ•´çš„æ€€å­•ç³»ç»Ÿï¼ŒåŒ…å«å¦Šå¨ å¯Ÿè§‰åº¦ã€åˆ†å¨©é˜¶æ®µã€è¿‡æœŸå¦Šå¨ ç­‰åŠŸèƒ½",
  "entries": [
    {
      "uid": 1,
      "key": [],
      "keysecondary": [],
      "comment": "[InitialVariables] Pregnancy System Config",
      "content": "{\n  \"pregnancy\": {\n    \"config\": {\n      \"autoDetectTime\": true,\n      \"debug\": true,\n      \"timeMultiplier\": 1.0,\n      \"hourPerMessage\": 0.5,\n      \"baseLaborTriggerChance\": 0.3,\n      \"maxOverdueDays\": 14,\n      \"awarenessGrowthRate\": 2\n    }\n  }\n}",
      "constant": false,
      "selective": false,
      "selectiveLogic": 0,
      "addMemo": true,
      "order": 100,
      "position": 0,
      "disable": false,
      "excludeRecursion": false,
      "probability": 100,
      "useProbability": true
    },
    {
      "uid": 2,
      "key": [],
      "keysecondary": [],
      "comment": "Pregnancy System Manager",
      "content": "@@dont_activate\n@@only_preload\n<%\n// æ€€å­•ç³»ç»Ÿç®¡ç†å™¨ - æ ¸å¿ƒå‡½æ•°åº“\n\nfunction initPregnancy(charName) {\n    const key = `pregnancy.${charName}`;\n    if (!getvar(key)) {\n        setvar(key, {\n            isPregnant: false,\n            days: 0,\n            stage: 'none',\n            father: '',\n            symptoms: [],\n            laborStage: 'none',\n            laborHours: 0,\n            totalLaborHours: 9,\n            birthProgress: 0,\n            hasWaterBroken: false,\n            contractionLevel: 0,\n            isOverdue: false,\n            overdueDays: 0,\n            lastLaborCheckMessage: -1,\n            laborTriggerAttempts: 0,\n            awareness: 0,\n            awarenessStage: 'unaware',\n            hasSeenDoctor: false,\n            knownInfo: {\n                isPregnant: false,\n                dueDate: false,\n                fetusCount: false,\n                fetusSex: false,\n                fetusHealth: false\n            },\n            fetusCount: 1\n        }, { scope: 'local' });\n    }\n}\n\nfunction updateLaborStage(charName) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data) return null;\n    \n    const hours = data.laborHours;\n    \n    if (hours < 3) {\n        data.laborStage = 'prelabor';\n        data.contractionLevel = Math.floor(hours * 3);\n        data.hasWaterBroken = false;\n        data.birthProgress = 0;\n    } else if (hours < 6) {\n        data.laborStage = 'stage1';\n        data.contractionLevel = 10;\n        data.hasWaterBroken = true;\n        data.birthProgress = Math.floor((hours - 3) / 3 * 40);\n    } else if (hours < 9) {\n        data.laborStage = 'stage2';\n        data.contractionLevel = 10;\n        data.hasWaterBroken = true;\n        data.birthProgress = 40 + Math.floor((hours - 6) / 3 * 60);\n    } else {\n        data.laborStage = 'delivered';\n        data.contractionLevel = 0;\n        data.birthProgress = 100;\n        data.isPregnant = false;\n    }\n    \n    setvar(key, data, { scope: 'local' });\n    return data;\n}\n\nfunction advanceLaborTime(charName, hours = 0.5) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data || data.laborStage === 'none') return null;\n    \n    data.laborHours += hours;\n    setvar(key, data, { scope: 'local' });\n    \n    return updateLaborStage(charName);\n}\n\nfunction getLaborStageDescription(charName) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data || data.laborStage === 'none') return null;\n    \n    const stageDescriptions = {\n        'prelabor': {\n            name: 'äº§å‰é˜µç—›',\n            duration: '0-3å°æ—¶'\n        },\n        'stage1': {\n            name: 'ç¬¬ä¸€äº§ç¨‹ï¼ˆç ´æ°´æœŸï¼‰',\n            duration: '3-6å°æ—¶'\n        },\n        'stage2': {\n            name: 'ç¬¬äºŒäº§ç¨‹ï¼ˆå¨©å‡ºæœŸï¼‰',\n            duration: '6-9å°æ—¶'\n        },\n        'delivered': {\n            name: 'åˆ†å¨©å®Œæˆ',\n            duration: 'å®Œæˆ'\n        }\n    };\n    \n    return stageDescriptions[data.laborStage] || null;\n}\n\nfunction setPregnant(charName, father = userName) {\n    initPregnancy(charName);\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    \n    data.isPregnant = true;\n    data.days = 0;\n    data.stage = 'early';\n    data.father = father;\n    data.conceptionDate = new Date().toISOString();\n    data.laborStage = 'none';\n    data.laborHours = 0;\n    data.birthProgress = 0;\n    data.hasWaterBroken = false;\n    data.contractionLevel = 0;\n    data.awareness = 0;\n    data.awarenessStage = 'unaware';\n    \n    setvar(key, data, { scope: 'local' });\n    return `âœ“ ${charName} å·²æ€€å­•ï¼ˆå—å­•è€…ï¼š${father}ï¼‰`;\n}\n\nfunction advanceTime(days = 1) {\n    const allVars = variables;\n    const results = [];\n    \n    for (const key in allVars) {\n        if (key.startsWith('pregnancy.') && !key.includes('.config')) {\n            const charName = key.replace('pregnancy.', '');\n            const data = getvar(key);\n            \n            if (data && data.isPregnant) {\n                const oldDays = data.days;\n                data.days += days;\n                \n                if (data.days < 84) {\n                    data.stage = 'early';\n                } else if (data.days < 196) {\n                    data.stage = 'mid';\n                } else if (data.days < 280) {\n                    data.stage = 'late';\n                } else {\n                    data.stage = 'labor';\n                    \n                    if (oldDays < 280 && data.laborStage === 'none') {\n                        data.laborStage = 'prelabor';\n                        data.laborHours = 0;\n                        results.push(`ğŸš¨ ${charName}åˆ°è¾¾é¢„äº§æœŸï¼Œè¿›å…¥äº§å‰é˜µç—›æœŸï¼`);\n                    }\n                }\n                \n                setvar(key, data, { scope: 'local' });\n                \n                const weeks = Math.floor(data.days / 7);\n                results.push(`${charName}: ${oldDays}å¤© â†’ ${data.days}å¤© (${weeks}å‘¨)`);\n            }\n        }\n    }\n    \n    return results.length > 0 ? results.join('\\n') : 'æ²¡æœ‰è§’è‰²æ€€å­•';\n}\n\nfunction getPregnancyStatus(charName) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key, { defaults: null });\n    \n    if (!data) {\n        return `${charName}: æœªåˆå§‹åŒ–`;\n    }\n    \n    if (!data.isPregnant && data.laborStage === 'none') {\n        return `${charName}: æœªæ€€å­•`;\n    }\n    \n    if (data.laborStage !== 'none' && data.laborStage !== 'delivered') {\n        const desc = getLaborStageDescription(charName);\n        return `${charName}: ${desc.name} (${data.laborHours.toFixed(1)}å°æ—¶, è¿›åº¦${data.birthProgress}%)`;\n    }\n    \n    if (data.laborStage === 'delivered') {\n        return `${charName}: å·²åˆ†å¨© (äº§ç¨‹${data.laborHours.toFixed(1)}å°æ—¶)`;\n    }\n    \n    const stages = {\n        'early': 'æ—©æœŸï¼ˆ0-12å‘¨ï¼‰',\n        'mid': 'ä¸­æœŸï¼ˆ13-27å‘¨ï¼‰',\n        'late': 'æ™šæœŸï¼ˆ28-40å‘¨ï¼‰',\n        'labor': 'ä¸´äº§æœŸ'\n    };\n    \n    return `${charName}: æ€€å­•ä¸­ï¼ˆç¬¬${data.days}å¤©/280å¤©ï¼Œ${stages[data.stage] || data.stage}ï¼‰`;\n}\n\nfunction updateAwarenessStage(charName) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data) return null;\n    \n    const awareness = data.awareness;\n    const oldStage = data.awarenessStage;\n    \n    if (awareness < 25) {\n        data.awarenessStage = 'unaware';\n    } else if (awareness < 50) {\n        data.awarenessStage = 'suspect';\n    } else if (awareness < 75) {\n        data.awarenessStage = 'confirmed';\n    } else {\n        data.awarenessStage = 'fully_aware';\n    }\n    \n    if (data.awarenessStage === 'confirmed' || data.awarenessStage === 'fully_aware') {\n        data.knownInfo.isPregnant = true;\n    }\n    \n    if (data.awarenessStage === 'fully_aware') {\n        data.knownInfo.dueDate = true;\n        data.knownInfo.fetusCount = true;\n    }\n    \n    setvar(key, data, { scope: 'local' });\n    \n    if (oldStage !== data.awarenessStage) {\n        console.log(`[Pregnancy] ${charName} å¯Ÿè§‰åº¦é˜¶æ®µå˜åŒ–: ${oldStage} â†’ ${data.awarenessStage}`);\n        return {\n            changed: true,\n            oldStage,\n            newStage: data.awarenessStage,\n            awareness\n        };\n    }\n    \n    return null;\n}\n\nfunction increaseAwareness(charName, amount = 1, reason = '') {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data || !data.isPregnant) return null;\n    \n    const oldAwareness = data.awareness;\n    data.awareness = Math.min(100, data.awareness + amount);\n    \n    setvar(key, data, { scope: 'local' });\n    \n    const stageChange = updateAwarenessStage(charName);\n    \n    console.log(`[Pregnancy] ${charName} å¯Ÿè§‰åº¦å¢åŠ : ${oldAwareness} â†’ ${data.awareness} ${reason ? `(${reason})` : ''}`);\n    \n    return {\n        oldAwareness,\n        newAwareness: data.awareness,\n        stageChange\n    };\n}\n\nfunction getAwarenessStageInfo(charName) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data || !data.isPregnant) return null;\n    \n    const stages = {\n        'unaware': {\n            name: 'æ— æ„è¯†æœŸ',\n            icon: 'ğŸ¤·',\n            description: 'è§’è‰²å®Œå…¨ä¸çŸ¥é“è‡ªå·±æ€€å­•',\n            range: '0-24'\n        },\n        'suspect': {\n            name: 'æ€€ç–‘æœŸ',\n            icon: 'ğŸ¤”',\n            description: 'å¼€å§‹æ€€ç–‘ä½†ä¸ç¡®å®š',\n            range: '25-49'\n        },\n        'confirmed': {\n            name: 'ç¡®è®¤æœŸ',\n            icon: 'âœ“',\n            description: 'ç¡®è®¤æ€€å­•ä½†ç¼ºä¹è¯¦ç»†ä¿¡æ¯',\n            range: '50-74'\n        },\n        'fully_aware': {\n            name: 'å®Œå…¨å¯Ÿè§‰æœŸ',\n            icon: 'ğŸ“‹',\n            description: 'å®Œå…¨äº†è§£èƒå„¿çŠ¶å†µ',\n            range: '75-100'\n        }\n    };\n    \n    return stages[data.awarenessStage] || stages['unaware'];\n}\n\nfunction visitDoctor(charName) {\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    if (!data || !data.isPregnant) return null;\n    \n    const oldAwareness = data.awareness;\n    \n    if (data.awareness < 50) {\n        data.awareness = 50;\n    } else {\n        data.awareness = Math.min(100, data.awareness + 30);\n    }\n    \n    data.hasSeenDoctor = true;\n    data.knownInfo.isPregnant = true;\n    data.knownInfo.dueDate = true;\n    data.knownInfo.fetusCount = true;\n    data.knownInfo.fetusHealth = true;\n    \n    if (data.days >= 140) {\n        data.knownInfo.fetusSex = true;\n    }\n    \n    setvar(key, data, { scope: 'local' });\n    updateAwarenessStage(charName);\n    \n    return {\n        oldAwareness,\n        newAwareness: data.awareness,\n        stageChange: true,\n        knownInfo: data.knownInfo\n    };\n}\n\ndefine('pregnancySystem', {\n    setPregnant,\n    getPregnancyStatus,\n    advanceTime,\n    initPregnancy,\n    updateLaborStage,\n    advanceLaborTime,\n    getLaborStageDescription,\n    updateAwarenessStage,\n    increaseAwareness,\n    getAwarenessStageInfo,\n    visitDoctor\n});\n_%>",
      "constant": false,
      "selective": false,
      "selectiveLogic": 0,
      "addMemo": true,
      "order": 99,
      "position": 0,
      "disable": false,
      "excludeRecursion": false,
      "probability": 100,
      "useProbability": true
    },
    {
      "uid": 3,
      "key": [],
      "keysecondary": [],
      "comment": "[GENERATE:BEFORE] Labor Trigger Checker",
      "content": "@@generate_before\n<%\n// åˆ†å¨©è§¦å‘æ£€æµ‹ç³»ç»Ÿ\nconst config = getvar('pregnancy.config', { defaults: {} });\nconst baseTriggerChance = config.baseLaborTriggerChance || 0.3;\nconst maxOverdueDays = config.maxOverdueDays || 14;\n\nconst allVars = variables;\n\nfor (const key in allVars) {\n    if (key.startsWith('pregnancy.') && !key.includes('.config')) {\n        const charName = key.replace('pregnancy.', '');\n        const data = getvar(key);\n        \n        if (!data || !data.isPregnant || data.laborStage !== 'none') continue;\n        \n        if (data.days >= 280) {\n            const overdueDays = data.days - 280;\n            \n            if (data.lastLaborCheckMessage === lastCharMessageId) continue;\n            data.lastLaborCheckMessage = lastCharMessageId;\n            \n            let triggerChance = baseTriggerChance;\n            \n            if (overdueDays > 0) {\n                triggerChance = baseTriggerChance + (overdueDays / maxOverdueDays) * (1 - baseTriggerChance);\n                \n                if (overdueDays >= maxOverdueDays) {\n                    triggerChance = 1.0;\n                }\n                \n                data.isOverdue = true;\n                data.overdueDays = overdueDays;\n            }\n            \n            const random = Math.random();\n            data.laborTriggerAttempts++;\n            \n            console.log(`[Pregnancy] ${charName} åˆ†å¨©è§¦å‘æ£€æµ‹: è¿‡æœŸ${overdueDays}å¤©, æ¦‚ç‡${(triggerChance*100).toFixed(1)}%, éšæœºæ•°${random.toFixed(3)}`);\n            \n            if (random < triggerChance) {\n                data.laborStage = 'prelabor';\n                data.laborHours = 0;\n                data.birthProgress = 0;\n                data.contractionLevel = 0;\n                \n                setvar(key, data, { scope: 'local' });\n                \n                const messages = [\n                    `ğŸš¨ ${charName}çªç„¶æ„Ÿåˆ°ä¸€é˜µå¼ºçƒˆçš„å®«ç¼©â€”â€”åˆ†å¨©å¼€å§‹äº†ï¼`,\n                    `âš¡ ${charName}æ„Ÿåˆ°è…¹éƒ¨ä¸€é˜µç´§ç»·ï¼Œäº§å‰é˜µç—›å¼€å§‹äº†...`,\n                    `ğŸ’« ${charName}çš„èº«ä½“å‘å‡ºä¿¡å·ï¼šæ˜¯æ—¶å€™äº†...åˆ†å¨©å³å°†å¼€å§‹ï¼`\n                ];\n                \n                if (overdueDays > 0) {\n                    messages.push(`ğŸ“… æ³¨æ„ï¼š${charName}å·²è¿‡é¢„äº§æœŸ${overdueDays}å¤©`);\n                }\n                \n                print(`\\n<div style=\"padding:12px;margin:8px 0;background:#FF6B6B;color:white;border-radius:8px;font-weight:bold;\">\n                    ${messages[Math.floor(Math.random() * 3)]}\n                    ${overdueDays > 0 ? `<br><small style=\"opacity:0.9;\">${messages[3]}</small>` : ''}\n                </div>\\n`);\n                \n            } else {\n                setvar(key, data, { scope: 'local' });\n                \n                if (config.debug && overdueDays > 0) {\n                    print(`\\n<div style=\"padding:8px;margin:4px 0;background:#FFF3CD;border-left:3px solid #FFC107;font-size:0.9em;\">\n                        â³ ${charName}å·²è¿‡é¢„äº§æœŸ${overdueDays}å¤©ï¼Œä½†å°šæœªè¿›å…¥äº§ç¨‹ï¼ˆè§¦å‘æ¦‚ç‡${(triggerChance*100).toFixed(1)}%ï¼‰\n                    </div>\\n`);\n                }\n            }\n        }\n    }\n}\n_%>",
      "constant": false,
      "selective": false,
      "selectiveLogic": 0,
      "addMemo": true,
      "order": 50,
      "position": 0,
      "disable": false,
      "excludeRecursion": false,
      "probability": 100,
      "useProbability": true
    },
    {
      "uid": 4,
      "key": [],
      "keysecondary": [],
      "comment": "[GENERATE:BEFORE] Auto Time & Labor Advance",
      "content": "@@generate_before\n<%\n// è‡ªåŠ¨æ¨è¿›åˆ†å¨©æ—¶é—´\nconst config = getvar('pregnancy.config', { defaults: {} });\nconst hourPerMessage = config.hourPerMessage || 0.5;\n\nconst allVars = variables;\nfor (const key in allVars) {\n    if (key.startsWith('pregnancy.') && !key.includes('.config')) {\n        const charName = key.replace('pregnancy.', '');\n        const data = getvar(key);\n        \n        if (data && data.laborStage !== 'none' && data.laborStage !== 'delivered') {\n            pregnancySystem.advanceLaborTime(charName, hourPerMessage);\n            \n            const updated = getvar(key);\n            console.log(`[Pregnancy] ${charName} åˆ†å¨©æ¨è¿›: ${updated.laborHours.toFixed(1)}å°æ—¶, é˜¶æ®µ: ${updated.laborStage}`);\n        }\n    }\n}\n_%>",
      "constant": false,
      "selective": false,
      "selectiveLogic": 0,
      "addMemo": true,
      "order": 49,
      "position": 0,
      "disable": false,
      "excludeRecursion": false,
      "probability": 100,
      "useProbability": true
    },
    {
      "uid": 5,
      "key": [],
      "keysecondary": [],
      "comment": "[GENERATE:BEFORE] Awareness Auto Growth",
      "content": "@@generate_before\n<%\n// å¯Ÿè§‰åº¦è‡ªåŠ¨å¢é•¿ç³»ç»Ÿ\nconst config = getvar('pregnancy.config', { defaults: {} });\nconst growthRate = config.awarenessGrowthRate || 2;\n\nconst allVars = variables;\n\nfor (const key in allVars) {\n    if (key.startsWith('pregnancy.') && !key.includes('.config')) {\n        const charName = key.replace('pregnancy.', '');\n        const data = getvar(key);\n        \n        if (!data || !data.isPregnant || data.awareness >= 100) continue;\n        \n        let growth = growthRate;\n        \n        if (data.days >= 56) growth += 1;\n        if (data.days >= 84) growth += 2;\n        if (data.days >= 140) growth += 3;\n        if (data.days >= 196) growth += 5;\n        if (data.isOverdue) growth += 10;\n        \n        if (data.laborStage !== 'none') {\n            data.awareness = 100;\n            setvar(key, data, { scope: 'local' });\n            pregnancySystem.updateAwarenessStage(charName);\n            continue;\n        }\n        \n        const result = pregnancySystem.increaseAwareness(charName, growth, 'è‡ªç„¶å¢é•¿');\n        \n        if (result && result.stageChange && result.stageChange.changed) {\n            const info = pregnancySystem.getAwarenessStageInfo(charName);\n            if (config.debug) {\n                print(`\\n<div style=\"padding:8px;margin:4px 0;background:#E3F2FD;border-left:3px solid #2196F3;font-size:0.9em;\">\n                    ${info.icon} ${charName} è¿›å…¥ã€${info.name}ã€‘ï¼ˆå¯Ÿè§‰åº¦: ${result.newAwareness}ï¼‰\n                </div>\\n`);\n            }\n        }\n    }\n}\n_%>",
      "constant": false,
      "selective": false,
      "selectiveLogic": 0,
      "addMemo": true,
      "order": 48,
      "position": 0,
      "disable": false,
      "excludeRecursion": false,
      "probability": 100,
      "useProbability": true
    },
    {
      "uid": 6,
      "key": [],
      "keysecondary": [],
      "comment": "[GENERATE:BEFORE] Pregnancy Command Handler",
      "content": "@@generate_before\n<%\n// å‘½ä»¤å¤„ç†ç³»ç»Ÿ\nconst lastUserMsg = getChatMessage(lastUserMessageId);\nif (!lastUserMsg) return;\n\nconst msg = lastUserMsg.mes.trim();\n\n// /pregnant <è§’è‰²å>\nconst pregnantMatch = msg.match(/^\\/pregnant\\s+(.+)$/);\nif (pregnantMatch) {\n    const charName = pregnantMatch[1].trim();\n    const result = pregnancySystem.setPregnant(charName);\n    print(`\\n${result}\\n`);\n}\n\n// /pregnant-status\nif (msg === '/pregnant-status') {\n    const allVars = variables;\n    const statuses = [];\n    \n    for (const key in allVars) {\n        if (key.startsWith('pregnancy.') && !key.includes('.config')) {\n            const charName = key.replace('pregnancy.', '');\n            statuses.push(pregnancySystem.getPregnancyStatus(charName));\n        }\n    }\n    \n    if (statuses.length === 0) {\n        print('\\nğŸ“Š å½“å‰æ²¡æœ‰è§’è‰²æ€€å­•\\n');\n    } else {\n        print('\\nğŸ“Š æ€€å­•çŠ¶æ€ï¼š\\n' + statuses.join('\\n') + '\\n');\n    }\n}\n\n// /pregnant-advance <å¤©æ•°>\nconst advanceMatch = msg.match(/^\\/pregnant-advance\\s+(\\d+)$/);\nif (advanceMatch) {\n    const days = parseInt(advanceMatch[1]);\n    const result = pregnancySystem.advanceTime(days);\n    print(`\\nâ­ï¸ æ—¶é—´å·²æ¨è¿›${days}å¤©ï¼š\\n${result}\\n`);\n}\n\n// /pregnant-abort <è§’è‰²å>\nconst abortMatch = msg.match(/^\\/pregnant-abort\\s+(.+)$/);\nif (abortMatch) {\n    const charName = abortMatch[1].trim();\n    const key = `pregnancy.${charName}`;\n    setvar(key, {\n        isPregnant: false,\n        days: 0,\n        stage: 'none',\n        laborStage: 'none',\n        awareness: 0\n    }, { scope: 'local' });\n    print(`\\nâŒ ${charName} çš„æ€€å­•çŠ¶æ€å·²æ¸…é™¤\\n`);\n}\n\n// /pregnant-labor <è§’è‰²å>\nconst laborMatch = msg.match(/^\\/pregnant-labor\\s+(.+)$/);\nif (laborMatch) {\n    const charName = laborMatch[1].trim();\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    \n    if (data && data.isPregnant) {\n        data.days = 280;\n        data.stage = 'labor';\n        data.laborStage = 'prelabor';\n        data.laborHours = 0;\n        setvar(key, data, { scope: 'local' });\n        print(`\\nğŸš¨ ${charName}è¿›å…¥äº§å‰é˜µç—›æœŸï¼\\n`);\n    } else {\n        print(`\\nâŒ ${charName}æœªæ€€å­•ï¼Œæ— æ³•è§¦å‘åˆ†å¨©\\n`);\n    }\n}\n\n// /pregnant-induce <è§’è‰²å>\nconst induceMatch = msg.match(/^\\/pregnant-induce\\s+(.+)$/);\nif (induceMatch) {\n    const charName = induceMatch[1].trim();\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    \n    if (data && data.isPregnant && data.days >= 280 && data.laborStage === 'none') {\n        data.laborStage = 'prelabor';\n        data.laborHours = 0;\n        data.birthProgress = 0;\n        setvar(key, data, { scope: 'local' });\n        \n        print(`\\nğŸ’‰ å¯¹${charName}è¿›è¡Œäº†å‚¬äº§å¤„ç†ï¼Œåˆ†å¨©å¼€å§‹ï¼\\n`);\n    } else if (data && data.days < 280) {\n        print(`\\nâŒ ${charName}å°šæœªåˆ°é¢„äº§æœŸï¼ˆ${data.days}/280å¤©ï¼‰ï¼Œä¸å»ºè®®å‚¬äº§\\n`);\n    } else if (data && data.laborStage !== 'none') {\n        print(`\\nâŒ ${charName}å·²åœ¨åˆ†å¨©è¿‡ç¨‹ä¸­\\n`);\n    } else {\n        print(`\\nâŒ ${charName}æœªæ€€å­•\\n`);\n    }\n}\n\n// /pregnant-awareness <è§’è‰²å>\nconst awarenessMatch = msg.match(/^\\/pregnant-awareness\\s+(.+)$/);\nif (awarenessMatch) {\n    const charName = awarenessMatch[1].trim();\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    \n    if (data && data.isPregnant) {\n        const info = pregnancySystem.getAwarenessStageInfo(charName);\n        const known = data.knownInfo;\n        \n        print(`\\nğŸ“Š ${charName} å¯Ÿè§‰åº¦çŠ¶æ€ï¼š\\n        \n${info.icon} é˜¶æ®µï¼š${info.name}\nğŸ“ˆ å¯Ÿè§‰åº¦ï¼š${data.awareness}/100\nğŸ“‹ å­•å‘¨ï¼š${Math.floor(data.days / 7)}å‘¨\n\nã€å·²çŸ¥ä¿¡æ¯ã€‘\n${known.isPregnant ? 'âœ…' : 'âŒ'} çŸ¥é“è‡ªå·±æ€€å­•\n${known.dueDate ? 'âœ…' : 'âŒ'} çŸ¥é“é¢„äº§æœŸ\n${known.fetusCount ? 'âœ…' : 'âŒ'} çŸ¥é“èƒå„¿æ•°é‡\n${known.fetusSex ? 'âœ…' : 'âŒ'} çŸ¥é“èƒå„¿æ€§åˆ«\n${known.fetusHealth ? 'âœ…' : 'âŒ'} çŸ¥é“å¥åº·çŠ¶å†µ\n${data.hasSeenDoctor ? 'âœ…' : 'âŒ'} çœ‹è¿‡åŒ»ç”Ÿ\n\\n`);\n    } else {\n        print(`\\nâŒ ${charName}æœªæ€€å­•\\n`);\n    }\n}\n\n// /pregnant-awareness-add <è§’è‰²å> <æ•°å€¼>\nconst awarenessAddMatch = msg.match(/^\\/pregnant-awareness-add\\s+(.+?)\\s+(\\d+)$/);\nif (awarenessAddMatch) {\n    const charName = awarenessAddMatch[1].trim();\n    const amount = parseInt(awarenessAddMatch[2]);\n    \n    const result = pregnancySystem.increaseAwareness(charName, amount, 'æ‰‹åŠ¨å¢åŠ ');\n    if (result) {\n        const info = pregnancySystem.getAwarenessStageInfo(charName);\n        print(`\\nâœ“ ${charName}å¯Ÿè§‰åº¦å¢åŠ  +${amount}\nå½“å‰ï¼š${result.newAwareness}/100 (${info.icon} ${info.name})\n${result.stageChange && result.stageChange.changed ? `\\nğŸ‰ è¿›å…¥æ–°é˜¶æ®µï¼š${info.name}` : ''}\\n`);\n    } else {\n        print(`\\nâŒ ${charName}æœªæ€€å­•\\n`);\n    }\n}\n\n// /pregnant-doctor <è§’è‰²å>\nconst doctorMatch = msg.match(/^\\/pregnant-doctor\\s+(.+)$/);\nif (doctorMatch) {\n    const charName = doctorMatch[1].trim();\n    const result = pregnancySystem.visitDoctor(charName);\n    \n    if (result) {\n        const data = getvar(`pregnancy.${charName}`);\n        print(`\\nğŸ¥ ${charName}è¿›è¡Œäº†äº§æ£€ï¼š\n\nğŸ“ˆ å¯Ÿè§‰åº¦ï¼š${result.oldAwareness} â†’ ${result.newAwareness}\nğŸ“‹ æ£€æŸ¥ç»“æœï¼š\n   âœ… ç¡®è®¤æ€€å­•ï¼š${Math.floor(data.days / 7)}å‘¨\n   âœ… é¢„äº§æœŸï¼šçº¦${Math.max(0, 280 - data.days)}å¤©å\n   âœ… èƒå„¿æ•°é‡ï¼š${data.fetusCount || 1}ä¸ª\n   ${result.knownInfo.fetusSex ? 'âœ… æ€§åˆ«ï¼šå·²çŸ¥' : 'âš ï¸ æ€§åˆ«ï¼šæœªæ£€æŸ¥'}\n   âœ… å¥åº·çŠ¶å†µï¼šè‰¯å¥½\n\\n`);\n    } else {\n        print(`\\nâŒ ${charName}æœªæ€€å­•\\n`);\n    }\n}\n\n// /pregnant-test <è§’è‰²å>\nconst testMatch = msg.match(/^\\/pregnant-test\\s+(.+)$/);\nif (testMatch) {\n    const charName = testMatch[1].trim();\n    const key = `pregnancy.${charName}`;\n    const data = getvar(key);\n    \n    if (data && data.isPregnant) {\n        const result = pregnancySystem.increaseAwareness(charName, 20, 'éªŒå­•æ£’æµ‹è¯•');\n        print(`\\nğŸ§ª ${charName}ä½¿ç”¨äº†éªŒå­•æ£’ï¼š\n\nç»“æœï¼šä¸¤æ¡æ ï¼ˆé˜³æ€§ï¼‰\nå¯Ÿè§‰åº¦ï¼š${result.oldAwareness} â†’ ${result.newAwareness}\n\nğŸ’­ ${charName}${data.awarenessStage === 'unaware' ? 'éœ‡æƒŠåœ°çœ‹ç€æµ‹è¯•ç»“æœ...' : 'ç¡®è®¤äº†è‡ªå·±çš„æ€€ç–‘...'}\n\\n`);\n    } else {\n        print(`\\nğŸ§ª ${charName}ä½¿ç”¨äº†éªŒå­•æ£’ï¼š\n\nç»“æœï¼šä¸€æ¡æ ï¼ˆé˜´æ€§ï¼‰\n${charName}æœªæ€€å­•\n\\n`);\n    }\n}\n_%>",
      "constant": false,
      "selective": false,
      "selectiveLogic": 0,
      "addMemo": true,
      "order": 47,
      "position": 0,
      "disable": false,
      "excludeRecursion": false,
      "probability": 100,
      "useProbability": true
    }
  ]
}
